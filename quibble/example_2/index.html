<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Your First Fractal · Leios Labs</title><meta name="title" content="Your First Fractal · Leios Labs"/><meta property="og:title" content="Your First Fractal · Leios Labs"/><meta property="twitter:title" content="Your First Fractal · Leios Labs"/><meta name="description" content="Documentation for Leios Labs."/><meta property="og:description" content="Documentation for Leios Labs."/><meta property="twitter:description" content="Documentation for Leios Labs."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Leios Labs logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Leios Labs</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">General Information</a></li><li><a class="tocitem" href="../../content/about/">About Me</a></li><li><span class="tocitem">Quibble Docs</span><ul><li><a class="tocitem" href="../">Welcome</a></li><li><a class="tocitem" href="../justification/">Design Justifications</a></li><li><a class="tocitem" href="../workflow/">General Overview</a></li><li><a class="tocitem" href="../example_1/">A &#39;Fragment Shader&#39;</a></li><li class="is-active"><a class="tocitem" href>Your First Fractal</a><ul class="internal"><li><a class="tocitem" href="#Colors-with-Priority"><span>Colors with Priority</span></a></li><li><a class="tocitem" href="#Generating-functions-and-__stanzas"><span>Generating functions and <code>__stanza</code>s</span></a></li><li><a class="tocitem" href="#Conclusions"><span>Conclusions</span></a></li></ul></li></ul></li><li><span class="tocitem">GPU Kernel Handbook</span><ul><li><a class="tocitem" href="../../gpu-handbook/">Welcome</a></li><li><a class="tocitem" href="../../gpu-handbook/reviewers/">Reviewer Guidelines</a></li><li><a class="tocitem" href="../../gpu-handbook/about_me/">About the Author</a></li><li><a class="tocitem" href="../../gpu-handbook/intro/">Introduction</a></li><li><a class="tocitem" href="../../gpu-handbook/abstractions/">All the Ways to GPU</a></li></ul></li><li><span class="tocitem">Scribblings</span><ul><li><a class="tocitem" href="../../scribbleios/">Welcome</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">2024</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../scribbleios/2024/September/28/">A Second Chance</a></li><li><a class="tocitem" href="../../scribbleios/2024/February/20/">The Livestreaming Accident</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">2023</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../scribbleios/2023/2023/">The Read Message</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-4" type="checkbox"/><label class="tocitem" for="menuitem-5-4"><span class="docs-label">2022</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../scribbleios/2022/August/01/">The Commute</a></li><li><a class="tocitem" href="../../scribbleios/2022/May/10/">The USB Hero</a></li><li><a class="tocitem" href="../../scribbleios/2022/April/11/">The Modern Blacksmith</a></li><li><a class="tocitem" href="../../scribbleios/2022/April/07/">The Humbler</a></li><li><a class="tocitem" href="../../scribbleios/2022/March/30/">The Conscious Actor</a></li><li><a class="tocitem" href="../../scribbleios/2022/February/24/">Digital Selves</a></li><li><a class="tocitem" href="../../scribbleios/2022/February/15/">Walking to School</a></li><li><a class="tocitem" href="../../scribbleios/2022/February/11/">Wikipedia: Peter Shelly</a></li><li><a class="tocitem" href="../../scribbleios/2022/February/02/">Bittersweet Memories</a></li><li><a class="tocitem" href="../../scribbleios/2022/February/01/">Academic Correspondences</a></li><li><a class="tocitem" href="../../scribbleios/2022/January/31/">The Beowulf Poet</a></li><li><a class="tocitem" href="../../scribbleios/2022/January/23/">A Waste of Time</a></li><li><a class="tocitem" href="../../scribbleios/2022/January/02/">Describing a Tree</a></li><li><a class="tocitem" href="../../scribbleios/2022/January/06/">The Future</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-5" type="checkbox"/><label class="tocitem" for="menuitem-5-5"><span class="docs-label">2021</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../scribbleios/2021/December/12/">The NPC</a></li><li><a class="tocitem" href="../../scribbleios/2021/February/03/">A Talentless Student</a></li><li><a class="tocitem" href="../../scribbleios/2021/February/02/">The Master&#39;s Disciple</a></li><li><a class="tocitem" href="../../scribbleios/2021/February/01/">The Potion Master</a></li><li><a class="tocitem" href="../../scribbleios/2021/January/31/">The G00Gl3 Interview</a></li><li><a class="tocitem" href="../../scribbleios/2021/January/30/">A Mother&#39;s Love</a></li><li><a class="tocitem" href="../../scribbleios/2021/January/29/">The Creation Machine</a></li><li><a class="tocitem" href="../../scribbleios/2021/January/28/">The Great Collapse</a></li><li><a class="tocitem" href="../../scribbleios/2021/January/27/">Losing Myself</a></li><li><a class="tocitem" href="../../scribbleios/2021/January/26/">Merfolk</a></li><li><a class="tocitem" href="../../scribbleios/2021/January/22/">The Super Couple</a></li><li><a class="tocitem" href="../../scribbleios/2021/January/03/">The Girlfriend</a></li><li><a class="tocitem" href="../../scribbleios/2021/January/02/">The Anti-Poem</a></li><li><a class="tocitem" href="../../scribbleios/2021/January/01/">Who I Want to Be</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-6" type="checkbox"/><label class="tocitem" for="menuitem-5-6"><span class="docs-label">2020</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../scribbleios/2020/December/27/">Reincarnated Happiness</a></li><li><a class="tocitem" href="../../scribbleios/2020/December/26/">The Helpful Demon</a></li><li><a class="tocitem" href="../../scribbleios/2020/December/25/">Sophia and Aheb</a></li><li><a class="tocitem" href="../../scribbleios/2020/December/24/">Age Regression</a></li><li><a class="tocitem" href="../../scribbleios/2020/December/23/">Shy Gal</a></li><li><a class="tocitem" href="../../scribbleios/2020/December/12/">This is Not the End</a></li><li><a class="tocitem" href="../../scribbleios/2020/December/11/">All the Right Questions</a></li><li><a class="tocitem" href="../../scribbleios/2020/December/10/">Returning to the Sea</a></li><li><a class="tocitem" href="../../scribbleios/2020/December/09/">How Elves are Made</a></li><li><a class="tocitem" href="../../scribbleios/2020/December/08/">The American Hero</a></li><li><a class="tocitem" href="../../scribbleios/2020/December/07/">Jim</a></li><li><a class="tocitem" href="../../scribbleios/2020/December/06/">The Cult of Vi</a></li><li><a class="tocitem" href="../../scribbleios/2020/December/05/">Rhyming Truths</a></li><li><a class="tocitem" href="../../scribbleios/2020/December/04/">The Blind Dragon</a></li><li><a class="tocitem" href="../../scribbleios/2020/December/03/">Santa Stole the Money</a></li><li><a class="tocitem" href="../../scribbleios/2020/December/02/">The Angel of Mercy</a></li><li><a class="tocitem" href="../../scribbleios/2020/December/01/">The Genie Order</a></li><li><a class="tocitem" href="../../scribbleios/2020/November/30/">The Bargaining Protagonist</a></li><li><a class="tocitem" href="../../scribbleios/2020/November/29/">Raindrops on the Window</a></li><li><a class="tocitem" href="../../scribbleios/2020/October/06/">Happy Habitat</a></li><li><a class="tocitem" href="../../scribbleios/2020/October/05/">Another Castle</a></li><li><a class="tocitem" href="../../scribbleios/2020/October/04/">Glitching</a></li><li><a class="tocitem" href="../../scribbleios/2020/October/03/">Mirrors on the Wall</a></li><li><a class="tocitem" href="../../scribbleios/2020/October/02/">The Forest Guardian</a></li><li><a class="tocitem" href="../../scribbleios/2020/October/01/">The Prince of Time</a></li><li><a class="tocitem" href="../../scribbleios/2020/July/6/">The Sword and Shield</a></li><li><a class="tocitem" href="../../scribbleios/2020/July/4/">The Unsettling Sandwich</a></li><li><a class="tocitem" href="../../scribbleios/2020/July/3/">Afraid of the Light</a></li><li><a class="tocitem" href="../../scribbleios/2020/July/2/">The Demon Professor</a></li><li><a class="tocitem" href="../../scribbleios/2020/July/1/">Tree Traversing Super Power</a></li><li><a class="tocitem" href="../../scribbleios/2020/June/30/">Luminescent Love Story</a></li><li><a class="tocitem" href="../../scribbleios/2020/June/29/">Becoming Anything</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quibble Docs</a></li><li class="is-active"><a href>Your First Fractal</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Your First Fractal</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/leios/leios.github.io" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/leios/leios.github.io/blob/main/src/quibble/example_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Your-First-Fractal"><a class="docs-heading-anchor" href="#Your-First-Fractal">Your First Fractal</a><a id="Your-First-Fractal-1"></a><a class="docs-heading-anchor-permalink" href="#Your-First-Fractal" title="Permalink"></a></h1><p>Alright. I&#39;mma come out and say it. Everyone and their mother knows about the Sierpinski triangle. It&#39;s a triangle of triangles of triangles shown below:</p><p><img src="../res/example_2_out.png" alt="Sierpinski"/></p><p>In this example, we are creating the above image by following the same workflow <a href="../example_1/">as before</a>. It is strongly recommended to read the first example before continuing. I would also recommend you read the <a href="https://www.algorithm-archive.org/contents/IFS/IFS.html">Algorithm Archive chapter on Iterated Function Systems (IFS)s</a>, as it covers key information you might want (but don&#39;t need) to know about how the Sierpinski triangle is made. Finally, the full code can be <a href="https://github.com/leios/quibble/blob/main/examples/chaos.c">found here</a>. Please refer to that code if you have any questions!</p><p>For our purposes, this example will introduce two core concepts:</p><ol><li>Colors <em>with priority</em> to specify how colors interact with each other.</li><li>Generating functions which are usually functions tagged with the <code>__stanza</code> keyword and called with the <code>@SCALL</code> command in quibble scribbles.</li></ol><p>Let&#39;s start by examining the image above and picking it apart. If we wanted to be pedantic, we could say that the scribble we will be writing today should be doing 4 different actions:</p><ol><li>Creating a black background color</li><li>Outputting that color to screen</li><li>Creating a pink Sierpinski color</li><li>Outputting that to screen</li></ol><p>Steps 1 and 2 were (more or less) done in <a href="../example_1/">the last example</a> and shouldn&#39;t pose too much of a problem:</p><pre><code class="nohighlight hljs">...
    quibble_point_2D pt = qb_find_point_location(_idx, qcam);
    quibble_color_rgba8888 qcolor = qb_color_rgba8888(0,0,0,1);
    histogram_output_rgba8888(pt, qcolor, qcam, qps);
...
</code></pre><p>But there <em>is</em> a little snag here. Namely that these scribbles are being distributed to a bunch of cores. Some of these cores could finish their job quickly. Others might take some time. For this reason, we need some feature to distinguish what happens if (let&#39;s say) thread 1000 wants to write to the image, but there is already data there.</p><p>To solve this, I have introduced:</p><h2 id="Colors-with-Priority"><a class="docs-heading-anchor" href="#Colors-with-Priority">Colors with Priority</a><a id="Colors-with-Priority-1"></a><a class="docs-heading-anchor-permalink" href="#Colors-with-Priority" title="Permalink"></a></h2><p>Simply put, in addition to RGB(A) channels, there is an additional channel (P) for <em>priority</em>, which can be thought of as &quot;the distance away from the camera.&quot; Objects with a higher priority are closer. Objects with a lower priority are further away. Threads with color information can only write to screen if their color has a higher priority than the one already in memory. Note that the thread will also refuse to write to screen if it has a color with the <em>same</em> priority.</p><p>These are created similarly to other colors:</p><pre><code class="nohighlight hljs">quibble_pcolor_rgb888 = qb_pcolor_rgb888(0,0,0,0.5);
quibble_pcolor_rgba8888 = qb_pcolor_rgba8888(0,0,0,0,0.5);</code></pre><p>Where <code>pcolor</code> stands for &quot;priority color&quot; and the <code>0.5</code> at the end signifies the priority. Keep in mind that the priority (and all colors) are converted to an <code>unsigned char</code> value and (therefore) range from 0-255 in memory. Even so, we specify each of the channels as floats for user convenience.</p><p>So let&#39;s go ahead and set up everything <em>but</em> the scribble with this information in mind:</p><pre><code class="nohighlight hljs">#include &lt;stdio.h&gt;

#include &quot;quibble.h&quot;

int main(void){

    char *program = QBINLINE();

    quibble_program qp = qb_parse_program(program, &quot;&quot;);
    qb_print_program(qp);
    qb_configure_program(&amp;qp, 0, 0);

    int width = 1920;
    int height = 1080;
    quibble_pixels qpix = 
        qb_create_pixel_array(qp, width, height, PRGBA8888);

    float world_size_x = 4;
    float ppu = width / world_size_x;
    float world_size_y = height/ppu;

    float world_position_x = 0;
    float world_position_y = 0;

    quibble_simple_camera qcam = qb_create_simple_camera(ppu,
                                                         world_size_x,
                                                         world_size_y,
                                                         world_position_x,
                                                         world_position_y);
    qb_set_args(&amp;qp, &quot;chaos_shader&quot;, 2,
                &quot;quibble_pixels_prgba8888 qps&quot;, qpix,
                &quot;quibble_simple_camera qcam&quot;, &amp;qcam);

    qb_run(qp, &quot;chaos_shader&quot;, width*height, 256);

    qb_pixels_device_to_host(qpix);
    qb_write_png_file(&quot;check.png&quot;, qpix);

    qb_free_program(qp);
    qb_free_pixels(qpix);

    return 0;
}
</code></pre><p>This is basically identical to <a href="../example_1/">the previous example</a> except that we have a few <code>p</code>s thrown in to the color definitions. We will be calling our <code>__poem</code> <code>sierpinski_shader</code> for this example.</p><p>Now, let&#39;s add in the scribble for drawing the Sierpinski triangle.</p><h2 id="Generating-functions-and-__stanzas"><a class="docs-heading-anchor" href="#Generating-functions-and-__stanzas">Generating functions and <code>__stanza</code>s</a><a id="Generating-functions-and-__stanzas-1"></a><a class="docs-heading-anchor-permalink" href="#Generating-functions-and-__stanzas" title="Permalink"></a></h2><p>In a sense, Quibble has an overarching goal to minimize the amount of GPU memory stored for graphical applications. In this example, we are generating hundreds of millions of points for our final triangle, but only storing enough data for the final output image. How do we do this? Well, we are going to split up the process of generating each point so that <em>as we are generating the triangle, we are also performing other operations to that point and outputting it to screen.</em></p><p>In practice, this means that all Quibble primitives (the Sierpinski triangle included) will have specific locations for users to implement their own transformation functions. That is, in essence, what a <code>__stanza</code> is. A function that has a break point for user code that is written later.</p><p>For now, we don&#39;t need to drill too deeply into the details. Instead, let&#39;s cover the basics. Namely, the <code>sierpinski_chaos</code> <code>stanza</code> has a few function arguments:</p><ol><li><code>int num_iterations</code>: This is the number of times each point will move around and draw to screen.</li><li><code>quibble_simple_camera cam</code>: This is the camera, as described in <a href="../example_1/">the first example</a></li><li>Repeating pairs of <code>quibble_point_2D</code> and <code>quibble_pcolor_rgba8888</code> for <code>a</code>, <code>b</code>, and <code>c</code>, the three vertices of the triangle. The colors associated with each vertex will be used for the triangle closest to each vertex.</li></ol><p>Inside the stanza, there are also a few variables defined for users to call on in their user-code:</p><ol><li><code>quibble_point_2d _pt</code>: the point&#39;s location</li><li><code>quibble_pcolor_rgba8888 _clr</code>: the color associated with the latest function call.</li><li><code>int _i</code>: the iteration we are on for that, specific point.</li></ol><p>Ok, that should be enough information for the scribble:</p><pre><code class="nohighlight hljs">@include &quot;QB/chaos.qbl&quot;
@include &quot;QB/output.qbl&quot;
__poem chaos_shader(quibble_pixels_prgba8888 qps,
                    quibble_simple_camera qcam){

    // Setting the screen to black
    quibble_point_2D pt = qb_find_point_location(_idx, qcam);
    quibble_pcolor_rgba8888 qcolor = qb_pcolor_rgba8888(0,0,0,1,0.1);
    histogram_output_prgba8888(pt, qcolor, qcam, qps);

    // Creating a color for the triangle and setting vertex points
    qcolor = qb_pcolor_rgba8888(1,0,1,1,1);
    quibble_point_2D pt_1 = qb_point_2D(0, 0.5);
    quibble_point_2D pt_2 = qb_point_2D(-1, -0.5);
    quibble_point_2D pt_3 = qb_point_2D(1, -0.5);

    @SCALL sierpinski_chaos(100, qcam,
                            pt_1, qcolor,
                            pt_2, qcolor,
                            pt_3, qcolor){
        // Outputting to screen iff we are above iteration number 10
        // 10 is arbitrarily chosen and just makes sure we are actually
        // on the triangle
        if (_i &gt; 10){
            histogram_output_prgba8888(_pt, _clr, cam, qps);
        }

    }
}
</code></pre><p>And that&#39;s that.</p><p>A few quick notes:</p><ol><li>We are using <code>histogram_output_prgba8888</code> with a <code>p</code> in it for priority color.</li><li>We are injecting our own output command within the set of curly brackets after the <code>@SCALL</code>. If we did not output here, we would not see the triangle.</li></ol><h2 id="Conclusions"><a class="docs-heading-anchor" href="#Conclusions">Conclusions</a><a id="Conclusions-1"></a><a class="docs-heading-anchor-permalink" href="#Conclusions" title="Permalink"></a></h2><p>This example showcases how <code>__stanza</code>s are typically used in quibble scribbles. Namely as generating functions for object primitives.</p><div class="admonition is-info"><header class="admonition-header">A simple exercise</header><div class="admonition-body"><p>Do this again, but color each sub-triangle differently. Maybe one is read, another blue, and another green. Or whatever colors float your boat.</p><p>I&#39;m not your boss.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../example_1/">« A &#39;Fragment Shader&#39;</a><a class="docs-footer-nextpage" href="../../gpu-handbook/">Welcome »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Friday 1 August 2025 14:40">Friday 1 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
